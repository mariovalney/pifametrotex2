% !TeX encoding = UTF-8
% !TeX root = ../documento.tex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Customizações do abnTeX2 (https://www.abntex.net.br/)              %%
%% para os Projetos Integradores da Fametro                           %%
%%                                                                    %%
%% This work may be distributed and/or modified under the             %%
%% conditions of the LaTeX Project Public License, either version 1.3 %%
%% of this license or (at your option) any later version.             %%
%% The latest version of this license is in                           %%
%%   http://www.latex-project.org/lppl.txt                            %%
%% and version 1.3 or later is part of all distributions of LaTeX     %%
%% version 2005/12/01 or later.                                       %%
%%                                                                    %%
%% This work has the LPPL maintenance status `maintained'.            %%
%%                                                                    %%
%% The Current Maintainer of this work is Mário Valney                %%
%%                                                                    %%
%% Project available on: https://github.com/mariovalnet/pifametrotex2 %%
%%                                                                    %%
%% Further information about abnTeX2                                  %%
%% are available on https://www.abntex.net.br/                        %%
%%                                                                    %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Se você quer ver as margens do documento no PDF, remova o comentário dessa linha:
% \usepackage[showframe, pass]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%       Formatação das Páginas        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define o espaço entre linhas para 1.5 cm
%\OnehalfSpacing    Bug no ABNTEX2?
\renewcommand{\baselinestretch}{1.5}

% Define as margens do documento
\setlrmarginsandblock{3cm}{2cm}{*} % externa / interna
\setulmarginsandblock{3cm}{2cm}{*} % superior / inferior
\checkandfixthelayout

% Espacamentos nos titulos - chapter
\setlength{\beforechapskip}{-\onelineskip} % com 0 nao funcionou
\setlength{\afterchapskip}{\onelineskip} % antes do titulo de capitulo
%\setlength\beforechapskip{-18pt}
%\setlength{\afterchapskip}{2cm}

% Espacamentos nos titulos - section
%\setbeforesecskip{\onelineskip}
\setbeforesecskip{18pt}
\setaftersecskip{\onelineskip}

% Espacamentos nos titulos - subsection
\setbeforesubsecskip{\onelineskip}
\setaftersubsecskip{\onelineskip}

% Espacamentos nos titulos - subsubsection
\setbeforesubsubsecskip{\onelineskip}
\setaftersubsubsecskip{\onelineskip}

% Espacamentos nos titulos - subsubsubsection
\setbeforeparaskip{\onelineskip}
\setafterparaskip{\onelineskip}

% Define a distância da margem esquerda do parágrafo
\setlength{\parindent}{2cm}

% Estilo do chapter 1
\renewcommand{\ABNTEXchapterfont}{\bfseries}
\renewcommand{\ABNTEXchapterfontsize}{\normalsize}

% Estilo da section 1.1
\renewcommand{\ABNTEXsectionfont}{\bfseries}
\renewcommand{\ABNTEXsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1
\renewcommand{\ABNTEXsubsectionfont}{\normalfont\itshape}
\renewcommand{\ABNTEXsubsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1.1
\renewcommand{\ABNTEXsubsubsectionfont}{\normalfont}
\renewcommand{\ABNTEXsubsubsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1.1.1
\renewcommand{\ABNTEXsubsubsubsectionfont}{\normalfont}
\renewcommand{\ABNTEXsubsubsubsectionfontsize}{\normalsize}

\setsubsubsubsecheadstyle{
    \setlength{\parindent}{0cm}
    \normalfont\ABNTEXsubsubsubsectionfontsize\underline
}

% Os items da lista de figura agora sao negritos
\renewcommand{\cftfigurefont}{\bfseries}

% Os items da lista de tabela e quadro agora sao negritos
\renewcommand{\cfttablefont}{\bfseries}

% Números das páginas
\makepagestyle{abntheadings}
\makeevenhead{abntheadings}{\ABNTEXfontereduzida\thepage}{}{\ABNTEXfontereduzida\textit}
\makeoddhead{abntheadings}{}{}{\ABNTEXfontereduzida\thepage}
%\makeheadrule{abntheadings}{}{}

% Cabecalho do inicio do capitulo
\makepagestyle{abntchapfirst}
\makeoddhead{abntchapfirst}{}{}{\ABNTEXfontereduzida\thepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%              Comandos               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%% CAPA

\renewcommand{\imprimircapa}{%
    % Toda capa deve ter pagina 0
    \setcounter{page}{0}

    \begin{capa}%
        % Todos os elementos da capa devem esta centralizado
        \center

        % Todos os elementos da capa devem esta em negrito
        \bfseries

        \includegraphics[width=5cm]{assets/logo-fametro.png} \\
        \vspace{0.1cm}
        \MakeUppercase{\iesNome} \\
        \MakeUppercase{\capaCursoLinhaUm} \\
        \MakeUppercase{\capaCursoLinhaDois} \\

        \vspace{3cm}

        \MakeUppercase{\imprimirautor}

        \vspace{5cm}

        \begin{minipage}{12cm}
            \center
            \MakeUppercase{\imprimirtitulo}
        \end{minipage}

        \vfill
        \normalsize\MakeUppercase\imprimirlocal\par
        \normalsize\imprimirdata
    \end{capa}%
}

%%%%%%%%%%%%%%% FOLHA DE ROSTO

\makeatletter
\renewcommand{\folhaderostocontent}{%
    \begin{center}
        \normalsize\MakeUppercase\imprimirautor\par
        \vspace{6.5cm}

        \begin{minipage}{12cm}
            \center
            \normalsize\MakeUppercase\imprimirtitulo\par
        \end{minipage}
    \end{center}

    \vspace{2.5cm}

    %Retira o espaço do parágrafo
    \hspace*{-2cm}

    %Adiciona o espaço da margem
    \hspace*{8cm}

    \raggedleft

    \begin{minipage}{8cm}
        \begin{SingleSpace}
            \imprimirpreambulo
        \end{SingleSpace}
    \end{minipage}

    \vfill
    \centering
    \normalsize\MakeUppercase\imprimirlocal\par
    \normalsize\imprimirdata
}
\makeatother

%%%%%%%%%%%%%%% RESUMO

\newcommand{\fixindent}{
    \parindent 2cm
    \indent
}

\newcommand{\imprimirresumo}[1]{
    \begin{resumo}[Resumo] %
        {\fixindent\input{#1}}
    \end{resumo}
}

\newcommand{\palavraschave}[1]{
    \vspace{\onelineskip}
    \noindent Palavras-chave: #1
    \hypersetup{%
        pdfborder = {0 0 0}
    }
}

%%%%%%%%%%%%%%% SUMÁRIO

\renewcommand{\contentsname}{}

\newcommand{\imprimirsumario}{ %
    \pdfbookmark[0]{Sumário}{toc}
    \tableofcontents*
    \cleardoublepage
}

% Modifica o espaçamento no sumário
\setlength{\cftbeforeparagraphskip}{0pt}
\setlength{\cftbeforesubsectionskip}{0pt}
\setlength{\cftbeforesectionskip}{0pt}
\setlength{\cftbeforesubsubsectionskip}{0pt}
\setlength{\cftbeforechapterskip}{0pt}

\renewcommand\cftchapterfont{\ABNTEXchapterfont}
\renewcommand\cftsectionfont{\ABNTEXsectionfont}
\renewcommand\cftsubsectionfont{\ABNTEXsubsectionfont}
\renewcommand\cftsubsubsectionfont{\ABNTEXsubsubsectionfont}
\renewcommand*{\cftparagraphfont}{\normalsize\normalfont\underline}

% Formatação
\renewcommand\cftchapterpagefont{\normalfont}
\renewcommand\cftchapterpagefont{\normalfont}
\renewcommand\cftsectionpagefont{\normalfont}
\renewcommand\cftsubsectionpagefont{\normalfont}
\renewcommand\cftsubsubsectionpagefont{\normalfont}
\renewcommand\cftparagraphpagefont{\normalfont}

\renewcommand{\cftchapterleader}{\normalfont\cftdotfill{\cftdotsep}}
\renewcommand{\cftsectionleader}{\normalfont\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsectionleader}{\normalfont\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsubsectionleader}{\normalfont\cftdotfill{\cftdotsep}}
\renewcommand{\cftparagraphleader}{\normalfont\cftdotfill{\cftdotsep}}

% Note que o espaçamento entre números e seções é uma das demandas da Fametro que ferem a abntex2
% Caso esteja usando em outro relatório ou a Fametro tenha removido essas especificações, comente as linhas abaixo.

\renewcommand\numberlinebox[2]{#2\enspace}
\renewcommand\booknumberlinebox[2]{#2\enspace}
\renewcommand\partnumberlinebox[2]{#2\enspace}
\renewcommand\chapternumberlinebox[2]{#2\enspace}

\setlength{\cftlastnumwidth}{0em}

%%%%%%%%%%%%%%% REFERÊNCIAS

\newcommand{\imprimirreferencias}[1]{ %
    \bibliography{#1} %
    % TODO Por algum motivo, colocar esse comando antes da bibliografia faz com que o
    % ultimo capitulo dos elem fique sem o numero da pagina.
    \postextual %
}

%%%%%%%%%%%%%%% MISC

\newcommand{\Caption}[1]{ %
    \begin{Spacing}{1.5} %
        \caption{#1} %
    \end{Spacing} %
}

\newcommand{\Fonte}[2][\fontename]{ %
    \vspace{-5pt}
        \fonte[\normalfont{#1}]{\normalfont{#2}}
    \vspace{-5pt}
}

% Cria o comando para fazer notas e anotações na figura e na tabela
\newcommand{\Nota}[2][\notaname]{\Fonte[#1]{#2}}

% Comandos para inserir figuras, tabelas e quadros
\newcommand{\PIFFig}[3]{\IBGEtab{#1}{#2}{#3}}
\newcommand{\PIFTab}[3]{\IBGEtab{#1}{#2}{#3}}
\newcommand{\PIFQua}[3]{\IBGEtab{#1}{#2}{#3}}

\newcommand{\Figura}[3]{
    \begin{figure}[!htb]
        \centering

        \begin{minipage}{14cm}
            \begin{flushright}
                \Caption{#1}
                \includegraphics[width=14cm]{content/figuras/#2}
                \Fonte{#3}
            \end{flushright}
        \end{minipage}
    \end{figure}
}

\newcommand{\MinhaFigura}[2]{
    \Figura{#1}{#2}{Elaborado pelo autor}
}

\newcommand{\FiguraPagina}[3]{
    \Figura{#1}{#2}{#3}
    \clearpage
}

% Comando para marca d'água
\newcommand{\printWatermark}{
    \newwatermark[allpages,color=red!5,angle=45,scale=2]{RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO RASCUNHO}
}

% Comando para formatar listas como HTML
\newcommand{\lista}[1]{
    \begin{alineas}
        #1
    \end{alineas}
}

% Comando para citar sites
\newcommand{\citeurl}[1]{
    (\citeauthor{#1}, \citeyear{#1}, online)\xspace
}

\newcommand{\citeautoronline}[1]{
    \citeauthoronline{#1} (\citeyear{#1})\xspace
}